
# 第六章类文件的结构

概述：原本我们写的程序需要被编译器翻译为二进制格式才能被计算机识别，但是由于虚拟机已经建立在虚拟机之上的大量的程序语言的出现，越来越多的程序选择了与操作系统和机器指令无关的，平台中立的格式作为程序编译后的存储格式

### 无关性的基石
- sun公司及其他虚拟机提供商发布了许多可以运行在不同平台的虚拟机，这些虚拟机可以载入和执行同一种平台无关的字节码，从而实现，一次编写，到处运行。
-  各种不同平台的虚拟机与所有平台统一使用的额程序格式-字节码是构成平台无关性的基石。
-  通过不同的语言的编译器将程序编译成为字节码文件，只要符合字节码文件应有的格式就可以在虚拟机上运行。
- java语言中的变量，关键字和运算符号的语义最终个都是由多条字节码命令组合而成，因此字节码命令所能提供的语义描述能力肯定会比java强，在虚拟机上的不同语言对字节码命令语义特性支持的差异，是语言不同夫差异之一。
![图示](https://github.com/myismyself/book_tip_jvm/blob/master/jvm_book_img/class_chayi.png)

## class类文件的结构
- class文件是一组以8位字节为基础的二进制流，各个数据项目按照顺序紧凑的拍在Class文件中，没有任何分隔符，使得内容几乎全部是程序运行的必要数据。当遇到8位字节以上空间的数据项时，则按照高位在前的方式分割为若干个8位字节进行存储。
- 有两种数据类型：无符号数和表。
###### 无符号数
- 无符号数属于基本数据类型，用u1,u2,u4,u8来分别代表1个字节，2个字节，4个字节，8个字节的无符号数，无符号数可以用来描述数字，索引引用，数量值或按utf-8构成字符串值。
###### 表
- 表是由多个无符号数或其他表作为作为数据项构成的复合数据类型。常以_info结尾，class文件本质上就是一张表。
- 以下构成class文件的数据项，由于没有任何分隔符，所以表中的数据项，无论是顺序还是数量都被严格限定的
![构成class文件的数据项](https://github.com/myismyself/book_tip_jvm/blob/master/jvm_book_img/class_file_type.jpg)

## class文件中的数据类型

### 魔数（magic Number）和class文件的版本
-  每个class 文件的头4个字节被称为魔数，唯一的作用是来确定这个文件是否为一个能被虚拟机接受的class文件。
- 紧接着魔数后面的四个字节存储的是class文件的版本号：第5，6字节存储的是次版本号，7，8字节存储的是主版本号

### 常量池
- 主次版本号之后便是常量池，是class文件中第一个出现的 ```表数据类型```,在class项目中与其他项目关联最多的数据类型，也是占用class文件空间最大的数据项之一



